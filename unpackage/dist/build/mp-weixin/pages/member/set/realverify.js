(global["webpackJsonp"]=global["webpackJsonp"]||[]).push([["pages/member/set/realverify"],{"218b":function(e,t,n){"use strict";(function(e){Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var o=a(n("a34a")),i=n("2f62");function a(e){return e&&e.__esModule?e:{default:e}}function r(e,t,n,o,i,a,r){try{var s=e[a](r),c=s.value}catch(u){return void n(u)}s.done?t(c):Promise.resolve(c).then(o,i)}function s(e){return function(){var t=this,n=arguments;return new Promise(function(o,i){var a=e.apply(t,n);function s(e){r(a,o,i,s,c,"next",e)}function c(e){r(a,o,i,s,c,"throw",e)}s(void 0)})}}var c={data:function(){return{memberInfo:[],truename:"",cardid:"",upic1:"",upic2:"",iddate:"",pic1:"",pic2:"",logining:!1,showdate:"身份证截止有效期",is_realverify:"0",realverify:[],showTxt:"获取动态码",countdown:60,cTimer:null,smscode:"",first:!0}},computed:(0,i.mapState)(["hasLogin","userInfo"]),onLoad:function(){console.log("页面加载"),this.loadData()},methods:{loadData:function(){var t=this;this.hasLogin?t.$Request.post("member_index/realver").then(function(n){if(200==n.code){console.log(n);var o=t.userInfo;o.is_realverify=n.datas.member_info.is_realverify,t.is_realverify=n.datas.member_info.is_realverify,o.phone_show=n.datas.member_info.phone_show,o.phone=n.datas.member_info.phone,t.memberInfo=o,t.realverify=n.datas.member_info.realverify}else e.showToast({icon:"none",title:n.datas.error,duration:2e3}),e.navigateTo({url:"../login"})}):e.navigateTo({url:"../login"})},chooseUserImage:function(){var t=s(o.default.mark(function t(){var n;return o.default.wrap(function(t){while(1)switch(t.prev=t.next){case 0:n=this,e.chooseImage({sourceType:["camera","album"],sizeType:["original"],count:1,success:function(t){n.pic1=t.tempFilePaths[0],console.log(JSON.stringify(t.tempFilePaths)),n.$Request.upLoadFile("member_index/image_upload",n.pic1).then(function(t){console.log(t),console.log("===upload======"),200==t.code?(console.log("===upload=2====="),e.hideLoading(),console.log(t),n.upic1=t.datas.image_name):(e.showToast({icon:"none",title:t.datas.error,duration:2e3}),e.hideLoading())})}});case 2:case"end":return t.stop()}},t,this)}));function n(){return t.apply(this,arguments)}return n}(),chooseUserImage2:function(){var t=s(o.default.mark(function t(){var n;return o.default.wrap(function(t){while(1)switch(t.prev=t.next){case 0:n=this,e.chooseImage({sourceType:["camera","album"],sizeType:["original"],count:1,success:function(t){n.pic2=t.tempFilePaths[0],console.log(JSON.stringify(t.tempFilePaths)),n.$Request.upLoadFile("member_index/image_upload",n.pic2).then(function(t){console.log(t),console.log("===upload======"),200==t.code?(console.log("===upload=2====="),e.hideLoading(),console.log(t),n.upic2=t.datas.image_name):(e.showToast({icon:"none",title:t.datas.error,duration:2e3}),e.hideLoading())})}});case 2:case"end":return t.stop()}},t,this)}));function n(){return t.apply(this,arguments)}return n}(),formSubmit:function(){var t=this;if(console.log("----"),!/^[\u4e00-\u9fa5()]{2,10}$/.test(t.truename))return e.showToast({title:"请填写正确的姓名",icon:"none"}),!1;if(!/^[A-Za-z0-9]+$/.test(t.cardid)||18!=t.cardid.length)return e.showToast({title:"请填写正确的身份证号",icon:"none"}),!1;if(""==t.pic1)return e.showToast({title:"请上传身份证照片",icon:"none"}),!1;if(""==t.pic2)return e.showToast({title:"请上传身份证照片反面",icon:"none"}),!1;t.logining=!0;var n={truename:t.truename,cardid:t.cardid,iddate:t.iddate,pic1:t.upic1,pic2:t.upic2};t.$Request.post("member_index/realverify_add",n).then(function(n){200==n.code?(console.log(n),e.showToast({icon:"none",title:"验证资料提交成功！",duration:2e3,success:function(){setTimeout(function(){e.redirectTo({url:"/pages/member/set/userset"})},2e3)}})):(e.showToast({icon:"none",title:n.datas.error,duration:2e3}),t.logining=!1)}).catch(function(e){console.log(e)})},bindDateChange:function(e){console.log(e),this.iddate=e.target.value,this.showdate=e.target.value},getDate:function(e){var t=new Date,n=t.getFullYear(),o=t.getMonth()+1,i=t.getDate();return"start"===e?n-=60:"end"===e&&(n+=2),o=o>9?o:"0"+o,i=i>9?i:"0"+i,"".concat(n,"-").concat(o,"-").concat(i)},toSendSms:function(){var t=this;if(!/^1(3|4|5|6|7|8|9)\d{9}$/.test(this.memberInfo.phone))return e.showToast({title:"手机号码不正确",icon:"none"}),!1;t.$Request.post("connect/get_sms_captcha",{phone:t.memberInfo.phone,type:5}).then(function(n){200==n.code?(console.log(n),t.startTimer(),e.showToast({title:"验证码已发送",icon:"none",duration:2e3})):e.showToast({icon:"none",title:n.datas.error,duration:2e3})})},nextReg:function(){var t=this;return/^1(3|4|5|6|7|8|9)\d{9}$/.test(this.memberInfo.phone)?/^[0-9]*$/.test(this.smscode)&&6==this.smscode.length?(e.showLoading({title:"正在处理中..."}),void t.$Request.post("connect/check_sms_captcha",{phone:t.memberInfo.phone,yzcode:t.smscode,type:5}).then(function(n){200==n.code?(e.hideLoading(),console.log(n),t.first=!1,t.clearTimer()):(e.hideLoading(),e.showToast({icon:"none",title:n.datas.error,duration:2e3}))})):(e.showToast({title:"请填写正确的验证码",icon:"none"}),!1):(e.showToast({title:"手机号码错误",icon:"none"}),!1)},startTimer:function(){var e=this;null==e.cTimer&&(e.cTimer=setInterval(function(){e.countdown--,0==e.countdown&&e.clearTimer()},1e3))},clearTimer:function(){var e=this;clearInterval(e.cTimer),e.cTimer=null,e.countdown=60,e.showTxt="重新发送"}}};t.default=c}).call(this,n("543d")["default"])},"27af":function(e,t,n){"use strict";var o=n("56fa"),i=n.n(o);i.a},"4f83":function(e,t,n){"use strict";n.r(t);var o=n("70c6"),i=n("f848");for(var a in i)"default"!==a&&function(e){n.d(t,e,function(){return i[e]})}(a);n("27af");var r=n("2877"),s=Object(r["a"])(i["default"],o["a"],o["b"],!1,null,null,null);t["default"]=s.exports},"56fa":function(e,t,n){},"70c6":function(e,t,n){"use strict";var o=function(){var e=this,t=e.$createElement;e._self._c},i=[];n.d(t,"a",function(){return o}),n.d(t,"b",function(){return i})},"8f70":function(e,t,n){"use strict";(function(e){n("1857"),n("921b");o(n("66fd"));var t=o(n("4f83"));function o(e){return e&&e.__esModule?e:{default:e}}e(t.default)}).call(this,n("543d")["createPage"])},f848:function(e,t,n){"use strict";n.r(t);var o=n("218b"),i=n.n(o);for(var a in o)"default"!==a&&function(e){n.d(t,e,function(){return o[e]})}(a);t["default"]=i.a}},[["8f70","common/runtime","common/vendor"]]]);