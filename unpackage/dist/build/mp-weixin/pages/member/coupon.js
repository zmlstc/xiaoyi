(global["webpackJsonp"]=global["webpackJsonp"]||[]).push([["pages/member/coupon"],{"1c1a":function(t,e,o){"use strict";(function(t){o("1857"),o("921b");n(o("66fd"));var e=n(o("91f9"));function n(t){return t&&t.__esModule?t:{default:t}}t(e.default)}).call(this,o("543d")["createPage"])},2027:function(t,e,o){"use strict";var n=function(){var t=this,e=t.$createElement;t._self._c},s=[];o.d(e,"a",function(){return n}),o.d(e,"b",function(){return s})},"4adf":function(t,e,o){"use strict";o.r(e);var n=o("5c37"),s=o.n(n);for(var i in n)"default"!==i&&function(t){o.d(e,t,function(){return n[t]})}(i);e["default"]=s.a},"5c37":function(t,e,o){"use strict";(function(t){Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0;var n=i(o("a34a")),s=o("2f62");function i(t){return t&&t.__esModule?t:{default:t}}function a(t,e,o,n,s,i,a){try{var l=t[i](a),r=l.value}catch(u){return void o(u)}l.done?e(r):Promise.resolve(r).then(n,s)}function l(t){return function(){var e=this,o=arguments;return new Promise(function(n,s){var i=t.apply(e,o);function l(t){a(i,n,s,l,r,"next",t)}function r(t){a(i,n,s,l,r,"throw",t)}l(void 0)})}}var r=function(){return o.e("components/sl-filter/sl-filter").then(o.bind(null,"e160"))},u={data:function(){return{list:[],loadingText:"正在加载...",hasmore:!0,curpage:1,theIndex:null,oldIndex:null,isStop:!1,menuList:[{title:"排序",key:"sort",isSort:!0,reflexTitle:!0,detailList:[{title:"默认排序",value:""},{title:"兑换时间升",value:"dhasc"},{title:"兑换时间降",value:"dhdesc"},{title:"到期时间升",value:"dqasc"},{title:"到期时间降",value:"dqdesc"}]},{title:"状态",key:"state",isSort:!0,reflexTitle:!0,detailList:[{title:"全部",value:"0"},{title:"未使用",value:"1"},{title:"已使用",value:"2"},{title:"已失效",value:"3"}]}],bysort:"",state:0}},components:{slFilter:r},computed:(0,s.mapState)(["hasLogin","userInfo"]),onLoad:function(){console.log("页面加载"),this.loadData()},onReachBottom:function(){console.log("下拉加载..."),this.curpage++,this.loadData()},onPageScroll:function(){console.log("页面滚动...")},onPullDownRefresh:function(){console.log("上拉刷新..."),t.stopPullDownRefresh()},methods:{result:function(t){console.log(t);var e=JSON.parse(JSON.stringify(t)),o=Object.keys(e);console.log(o),"state"==o[0]?e["state"]!=this.state&&(this.state=e["state"],this.clearData(),this.loadData()):"sort"==o[0]&&e["sort"]!=this.bysort&&(this.bysort=e["sort"],this.clearData(),this.loadData())},clearData:function(){this.list=[],this.loadingText="正在加载...",this.hasmore=!0,this.curpage=1},loadData:function(){var e=l(n.default.mark(function e(){var o;return n.default.wrap(function(e){while(1)switch(e.prev=e.next){case 0:if(o=this,console.log("===userInfo==="+this.hasLogin),console.log(this.userInfo),console.log(this.userInfo.token),this.hasLogin){e.next=8;break}t.navigateTo({url:"login"}),e.next=12;break;case 8:if(this.hasmore){e.next=11;break}return this.loadingText="到底了",e.abrupt("return",!1);case 11:o.$Request.post("member_voucher/voucher_list",{curpage:o.curpage,state:o.state,bysort:o.bysort}).then(function(e){if(200==e.code){console.log(e),o.hasmore=e.hasmore,console.log(o.hasmore);for(var n=e.datas.list,s=0;s<n.length;s++)o.list.push(n[s]);o.hasmore||(o.loadingText="到底了")}else t.showToast({icon:"none",title:e.datas.error,duration:2e3}),t.navigateTo({url:"login"})});case 12:case"end":return e.stop()}},e,this)}));function o(){return e.apply(this,arguments)}return o}(),toPage:function(e){t.navigateTo({url:e})},touchStart:function(t,e){console.log("====touchStart===="),e.touches.length>1?this.isStop=!0:(this.oldIndex=this.theIndex,this.theIndex=null,this.initXY=[e.touches[0].pageX,e.touches[0].pageY])},touchMove:function(t,e){var o=this;if(console.log("====touchMove===="),e.touches.length>1)this.isStop=!0;else{var n=e.touches[0].pageX-this.initXY[0],s=e.touches[0].pageY-this.initXY[1];this.isStop||Math.abs(n)<5||(Math.abs(s)>Math.abs(n)?this.isStop=!0:n<0?(this.theIndex=t,this.isStop=!0):n>0&&null!=this.theIndex&&this.oldIndex==this.theIndex&&(this.oldIndex=t,this.theIndex=null,this.isStop=!0,setTimeout(function(){o.oldIndex=null},150)))}},touchEnd:function(t,e){console.log("====touchEnd===="),this.isStop=!1},deleteVoucher:function(e){var o=this;console.log("====deleteVoucher===="),o.$Request.post("member_voucher/voucherdelete",{voucher_id:e}).then(function(n){if(200==n.code){console.log(n);for(var s=o.list.length,i=0;i<s;i++)if(e==o.list[i].voucher_id){o.list.splice(i,1);break}o.oldIndex=null,o.theIndex=null}else t.showToast({icon:"none",title:n.datas.error,duration:2e3})})}}};e.default=u}).call(this,o("543d")["default"])},"91f9":function(t,e,o){"use strict";o.r(e);var n=o("2027"),s=o("4adf");for(var i in s)"default"!==i&&function(t){o.d(e,t,function(){return s[t]})}(i);o("bc0d");var a=o("2877"),l=Object(a["a"])(s["default"],n["a"],n["b"],!1,null,null,null);e["default"]=l.exports},bc0d:function(t,e,o){"use strict";var n=o("f0ca"),s=o.n(n);s.a},f0ca:function(t,e,o){}},[["1c1a","common/runtime","common/vendor"]]]);